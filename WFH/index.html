<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/x-icon" href="https://www.hraadvisors.com/wp-content/themes/madeo-child/_include/img/favicon.ico">
<link rel="icon" type="image/png" href="https://www.hraadvisors.com/wp-content/themes/madeo-child/_include/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.hraadvisors.com/wp-content/themes/madeo-child/_include/img/favicon-16x16.png" sizes="16x16">
<script src="https://www.hraadvisors.com/wp-includes/js/wp-emoji-release.min.js?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/javascript" defer=""></script>
<link rel="stylesheet" id="dashicons-css" href="https://www.hraadvisors.com/wp-includes/css/dashicons.min.css?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="https://www.hraadvisors.com/wp-includes/css/dist/block-library/style.min.css?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="https://www.hraadvisors.com/wp-content/themes/madeo/_include/css/bootstrap.min.css?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/css" media="all">

<link rel="stylesheet" id="main-styles-css" href="https://www.hraadvisors.com/wp-content/themes/madeo-child/style.css?ver=1.10.10" type="text/css" media="all">
    <link rel="stylesheet" id="custom-css" href="https://www.hraadvisors.com/wp-content/themes/madeo/_include/css/custom.css.php?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/css" media="all">
    <link rel="stylesheet" id="dynamic-colors-css" href="https://www.hraadvisors.com/wp-content/themes/madeo/_include/css/color.css.php?ver=a831c2bd8bc4349bb3674b1f5f4d29d3" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome" href="https://www.hraadvisors.com/wp-content/themes/madeo-child/_include/css/font-awesome.css" type="text/css" media="all">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src='https://api.mapbox.com/mapbox-gl-js/v1.10.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v1.10.1/mapbox-gl.css' rel='stylesheet' />

<style>

@font-face {
  font-family: GothamLight;
  src: url(/WFH/fonts/Gotham-Light.otf);
} 

  @font-face {
  font-family: GothamBook;
  src: url(Gotham-Book.otf);}

  @font-face {
  font-family: GothamMedium;
  src: url(/WFH//fonts/Gotham-Medium.otf);
}

.mapboxgl-ctrl-logo {
    display: none !important;
}

  #tooltip {
    position: absolute;
    display: none;
    background: rgba(0, 0, 0, .7);
    border-radius: 3px;
    box-shadow: -3px 3px 15px #939393;
    color: white;
    padding: 6px;
    font-family: "Merriweather";
    font-size: 1.1em;
    max-width: 400px;
    z-index: 100;
}
    
    .title{
    color: #2d2d35;
    font-family: GothamMedium;
    text-align: center;
    pointer-events: all;
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    position: relative;
    margin: auto;
    width: 80%;
    font-size: 1.8em;
    line-height: 1.2em;
    opacity: 1;
    justify-content: center
    }

    .timestamp{
      user-select: none;
    pointer-events: all;
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    color: #626262;
    text-align: center;
    width: auto;
    font-family: GothamLight;
    margin: 10px auto;
    font-size: 12px;
    opacity: 1;
    justify-content: center
    }

    .bodywrapper{
     padding-left:10%;
     padding-right:10%;
    }

body{
  margin: 0px auto;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

h1{
  margin: 50px;
}

h1{
  text-align: center;
}


#container{
  position: relative;
}

#sections{
  width: 340px;
  position: relative;
}

#sections > div{
  background: white;
  opacity: .2;
  margin-bottom: 200px;
}
#sections > div:last-child{
  margin-bottom: 30px;
}
#sections > div.graph-scroll-active{
  opacity: 1;
}

#graph{
  margin-left: 40px;
  width: 800px;
  height: 800px;
  position: -webkit-sticky;
  position: sticky;
  top: 0px;
  float: right;
  z-index: 0
}

.scrolldown{
position: relative;
cursor: initial;
font-family: "HaasTextBold",Arial,Helvetica;
color: #999999;
background: url(/WFH/img/scroll_buttons.png) no-repeat 0px 0px;
font-size: 18px;
line-height: 40px;
font-weight: bold;
max-width: 104px;
text-anchor: middle;
margin: 0px auto;
text-transform: capitalize;
margin-bottom: 4px;
top: -47px;
z-index: 1;
opacity: 1;
transition: opacity .15s ease-in-out;
}


@media (max-width: 925px)  {
  #graph{
    width: 100%;
    margin-left: 0px;
    float: none;
  }

  #sections{
    width: auto;
    position: relative;
    margin: 0px auto;
  }

  #sections > div{
    background: rgba(255,255,255,.5);
    padding: 10px;
    border-top: 1px solid;
    border-bottom: 1px solid;
    margin-bottom: 80vh;
  }

  pre{
    overflow: hidden;
  }

  h1{
    margin: 10px;
  }
}


.mono{
  font-family: monospace;
}



</style>
<body class="home page-template page-template-homepage page-template-homepage-php page page-id-5319 chrome page-homepage az wpb-js-composer js-comp-ver-3.6.2 vc_responsive is-device" data-gr-c-s-loaded="true" style="zoom: 1;">
<div id="tooltip"></div>
<div id="bg-blue">
  <header class="normal-header">

  <div class="container">
      <div class="row hidden-xs hidden-sm visible-md-block visible-lg-block">
            
    <div class="col-md-2 col-sm-3 col-xs-6">
    <div id="logo">
      <a href="https://www.hraadvisors.com" title="HR&amp;A">
                              <img class="standard" src="https://www.hraadvisors.com/wp-content/uploads/2015/10/logo.png" alt="HR&amp;A" width="89" height="41">
            <img class="retina" src="https://www.hraadvisors.com/wp-content/uploads/2015/10/logo-retina.png" alt="HR&amp;A" width="89" height="41">
                        </a>
    </div>
    </div>
            
        <div class="col-md-10 col-sm-9 col-xs-6" style="font-size: 1em;
    line-height: 1.750em;
    font-weight: 400;
    font-family: 'Open Sans', sans-serif;">
            <!-- Mobile Menu -->
            <a id="mobile-nav" class="menu-nav" href="#menu-nav"><span class="menu-icon"></span></a>
            <a id="search-button" class="search-toggle" href="#"><i class="fa fa-search fa-1"></i></a>
            <!-- Standard Menu -->
            <div id="menu" class="ajax-menu">
                <ul id="menu-nav" class="superfish">
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5457"><a href="https://www.hraadvisors.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8714"><a href="https://www.hraadvisors.com/team/">Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9885"><a href="https://www.hraadvisors.com/practice-areas/">Practice Areas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5354"><a href="https://www.hraadvisors.com/services/">Services</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5404"><a href="https://www.hraadvisors.com/portfolio/">Portfolio</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5419"><a href="https://www.hraadvisors.com/news/">News</a></li>
  
                <div id="marker" style="left: 838.969px; width: 63px; display: block;"></div>
                </ul>
            </div>
        </div>
      
        </div>
        
            
        <div class="row hidden-md hidden-lg visible-xs-block visible-sm-block">
            
            <div class="col-md-2 col-sm-2 col-xs-2">
                <!-- Mobile Menu -->
                <a id="mobile-nav" class="menu-trigger menu-nav" href="#"><span class="menu-icon"></span></a>
                
            </div>
            
            <div class="col-md-8 col-sm-8 col-xs-8 text-center">
    <div id="logo">
      <a href="https://www.hraadvisors.com" title="HR&amp;A">
                              <img class="standard" src="https://www.hraadvisors.com/wp-content/uploads/2015/10/logo.png" alt="HR&amp;A" width="89" height="41">
            <img class="retina" src="https://www.hraadvisors.com/wp-content/uploads/2015/10/logo-retina.png" alt="HR&amp;A" width="89" height="41">
                        </a>
    </div>
            </div>
            
            <div class="col-md-2 col-sm-2 col-xs-2 text-right">
                <!-- Search Icon -->
                <script src="https://kit.fontawesome.com/7a4305c6cb.js" crossorigin="anonymous"></script>
                <a id="search-button" class="search-toggle" href="#"><i class="fas fa-search"></i></a>
            </div>
        </div>
            </div>
</header>
</div>

<div class="bodywrapper">
<div class="title" style="opacity: 1;">Digital Adoption is a Resilience Imperative</div>
<div class="timestamp" style="opacity: 1;">By <a target="_blank" href="https://www.hraadvisors.com/team/kate-wittels/">Kate Wittels</a>, <a target="_blank" href="https://www.hraadvisors.com/team/jessica-jiang/%22">Jessica Jiang</a>, and Renee Barton  | May 15, 2020</div>
<br>
<br>
<br>
<br>
<br>
Over the past few months, digital tools have become indispensable to those who can accomplish their jobs digitally. As stay-at-home orders were put in place across the country, some Americans, many of whom were white, more educated, and higher income, were able to trade the open office for the open kitchen. For those workers, over half would prefer to continue to work remotely; Germany is considering mandating that all workers have the option to continue to work from home post-pandemic; and Twitter has announced that its employees will have the option to continue working from home indefinitely. In contrast, other workers, often lower-income, female, and non-white, were unable to conduct their work virtually and had to choose between a paycheck or exposure to the virus.
<br>
<br>
<br>
<br>
<br>
<div class="scrolldown"><p style='cursor: initial;
font-family: "HaasTextBold",Arial,Helvetica;
color: #999999;
font-size: 18px;
line-height: 40px;
font-weight: bold;
text-transform: capitalize;
margin-left: 50px;'>Scroll</p></div>
<br>
<br>



<div id='container' class='container-1'>
  <div id='graph'></div>
  <div id='sections'>
    <div>
<!-- Intentionally Blank -->
    </div>

    <div>
      <!--<h3>Show All Corridors; colored by category</h3>-->
      Recent studies from the St. Louis Fed and the University of Chicago’s Becker Friedman Institute estimate that between 33% and 37% of all occupations can be conducted virtually. While some occupations can easily transition to virtual work, such as web developers, accountants, and writers, jobholders in many other occupations, such as teachers, health care providers and researchers, will tell you that, while they can technically work from home, they cannot do their jobs effectively with only a home laptop and residential internet access.
      <svg id = 'legend3' width = '400px' height = '350px'></svg>
    </div>

    <div>
      <!--<h3>Zoom into one corridor</h3>-->
      To understand which occupations can work effectively from home and which cannot, we evaluated Occupational Information Network (O*NET) work activity profiles to develop the following four categories of occupations: <br><br>
       <b>(1)<font color = '#64B3FF'> jobs with the ability to conduct work virtually today</font></b>,<br>
        <b>(2)<font color = '#002E5C'> jobs with the ability to conduct work virtually with additional investments or planning</font></b>,<br>
         <b>(3)<font color = '#D9D9D9'> jobs that cannot be conducted virtually and are non-essential</font></b>, and<br>
        <b>(4)<font color = '#A5A5A5'> jobs that cannot be conducted virtually and are essential.</font></b><br>
        <br> We classified all occupations based on these four classifications, evaluating the distribution of jobs across classifications, and considering income, ethnicity, gender, educational attainment, and broadband access.
    </div>

    <div>
      <b>We conclude that a somewhat higher percentage than assumed by the St. Louis Fed and U. Chicago Becker Friedman Institute could work remotely, but that doing so effectively will require investments in universal access to high-speed internet, comprehensive training on virtual tools, and more user-friendly technology.</b> <br><br> Nationally, we believe only 23% of all jobs can easily transition to work from home effectively – i.e. in the midst of this pandemic, only 23% of American workers are able to perform their jobs at full productivity from home. If there were universal access to high-speed internet, comprehensive training on virtual tools, and more user-friendly technology, we estimate that an additional 19% of jobs could be performed productively in a virtual environment.
    </div>
    <div>
      <!--<h3>Zoom back out</h3>-->
      Included in this 19% are both jobs where the technology exists, but the training does not (e.g. teachers), and jobs that require technological innovation (e.g. scientists). Nearly a third of these workers (9 million) are in educational occupations, 1.2 million are in health care, and nearly 900,000 are scientists and researchers. While these jobs span a wide range of average income levels – from $46,000 for social service occupations to more than $100,000 in legal occupations – these are mostly middle-class jobs with a median wage of $55,000.<br><br>As we recover from COVID-19, and policymakers craft strategies to invest in universal broadband to build long-term resilience, they will need to remember that:
    </div>

    <div>
      <b>1. Class and gender will need to be considered to obtain results that are both equitable and efficient.</b><br>Currently, more than two-thirds of workers who could potentially work from home with further investments or planning cannot afford access to high-speed internet. Compounding the technological constraints, the majority of occupations that could work from home with better investment are performed by women (57% compared to a national average of 49%). With schools closed, the need for childcare and household support systems are needed now more than ever. Particularly in denser cities, many workers are finding their living arrangements too crowded to provide a quiet place to think.
    </div>

    <div>
      <!--<h3>Color by Essential/ Non-essential</h3>-->
      <b>2. Race is unsurprisingly also a major differentiator of those who may benefit from remote working and those who will not.</b></br>Nationally, non-white workers hold only 31% of jobs that can be conducted virtually, with or without investment. In the aggregate, jobs that cannot be conducted virtually pay less – an average income of $37,000 – and have lower educational requirements – 93% of these jobs do not require a bachelor’s degree. To ensure a more just and resilient recovery, reskilling programs will need to acknowledge racial inequities.
    </div>

    <div>
      <!--<h3>Color by Essential/ Non-essential</h3>-->
    </div>

    <div>
    <h3></h3>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    </div>

  </div>

</div>

<div id='container' class='container-2'>
  <div id='graph'></div>

  <div id='sections'>
    <div>
     <b>3. Not all cities are created equal.</b>b><br> In New Orleans, where the economy is driven largely by tourism, hospitality, and service jobs, only 19% of jobs can currently be conducted virtually. Conversely, in Washington DC, 33% of jobs can already be conducted virtually. If New Orleans prioritized universal broadband access, training, and technology development, an additional 19% of people could work virtually, meaning the overall share of the economy that could withstand future shocks would be closer to 38%.
    </div>

    <div>
      <b>4. Government will have to create markets, as it has in the past.</b><br> Technological innovation has transformed numerous consumer products and services, such as food delivery and transportation. Widespread adoption of technology by institutional sectors such as education, health care, and government has not occurred at the same pace. This is in large part because conventional sources of capital (e.g. venture investors) have yet to formulate strategies to navigate these sectors, which often have numerous stakeholders with sometimes competing agendas and complex regulatory barriers. Our long, successful history of government investing in medical research, military technology, space travel, and other major innovations, and then seeing the payoff in citizen well-being, is a precedent to which we should turn.<br><br>The COVID-19 pandemic is a reckoning for how we produce, consume, and learn. As a critical first response, to achieve magnitude of change needed, we need to tailor policy and funding approaches to local dynamics. Through strategic investments in high-speed internet, comprehensive training, and accelerated adoption of virtual technologies, more Americans could have the option to work virtually, allowing them to better withstand future shocks and enabling a more just and resilient path forward.
    </div>
</div>
<br>
<br>
<br>
</div>
<footer>

<!-- Start Footer Credits -->
<section id="footer-content">
    <div class="container-fluid">
        <div class="row">
            
            <div class="col-md-12 locations">
                <div class="col-md-6 col-xs-12 col-sm-6 hidden-lg hidden-md hidden-sm hidden-xs social-links-mobile">
                    <div class="inner-content">
                        <div class="social-links">
                                    <li id="menu-item-7109" class="fa fa-linkedin menu-item menu-item-type-custom menu-item-object-custom menu-item-7109"><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/82288">LinkedIn</a></li>
<li id="menu-item-7110" class="fa fa-twitter menu-item menu-item-type-custom menu-item-object-custom menu-item-7110"><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/hraadvisors">Twitter</a></li>
<li id="menu-item-7111" class="fa fa-facebook menu-item menu-item-type-custom menu-item-object-custom menu-item-7111"><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/hraadvisors/">Facebook</a></li>
<li id="menu-item-7112" class="fa fa-slideshare menu-item menu-item-type-custom menu-item-object-custom menu-item-7112"><a target="_blank" rel="noopener noreferrer" href="http://www.slideshare.net/HRAadvisors">Slide Share</a></li>
                        </div>
                        
                        
                    </div>
                </div>  
                
                
                
                               
            </div>
            
            <div class="col-md-4 col-xs-12 col-sm-12">
                                        <div class="inner-content" id="footer-logo">
                        <a href="https://www.hraadvisors.com" title="HR&amp;A">
                        <!--<img src="http://hraadvisors.pairserver.com/wp-content/uploads/2015/10/logo-retina.png" alt="HR&amp;A" >-->
                                                                    <img src="https://www.hraadvisors.com/wp-content/uploads/2015/10/logo-retina.png" alt="HR&amp;A">
                                        </a>
                    </div>
            </div>
                    <!--col-md-offset-4-->
            <div class="col-md-8">
            <!-- footer sign up form  -->
            <div class="col-md-12 subscribe-done" style="display: none;">
                <h3>Thanks for signing up for our email list. Look out for our insights and updates in your inbox!</h3>
            </div>    
            <div class="form-div-container">    
                <div class="col-md-12 intro-form-desc">
                    <p>Stay up to date with our insights on the future of city building</p>
                </div>
                <div class="col-md-12">
                    <div class="footer-form">
                        <div class="row">
                        <!-- Mailchimp singup form -->
                        <div id="mc_embed_signup">
                        <form action="https://hraadvisors.us9.list-manage.com/subscribe/post-json?u=569e6215860c116586a158d8f&amp;id=0f2eb5bc7f&amp;c=?" method="post" class="signup-email-form" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" novalidate="novalidate">
                        <!-- <div class="indicates-required"><span class="asterisk"></span> indicates required</div> -->
                        <div class="col-md-3 col-sm-3 col-xs-12">
                            
                                <!-- <label for="mce-FNAME">First Name </label> -->
                                <input type="text" value="" name="FNAME" required="" class="form-control footer-input" id="mce-FNAME" placeholder="First Name" aria-required="true">
                           
                        </div>

                        <div class="col-md-3 col-sm-3 col-xs-12">
                            
                                <!-- <label for="mce-LNAME">Last Name </label> -->
                                <input type="text" value="" name="LNAME" required="" class="form-control footer-input" id="mce-LNAME" placeholder="Last Name" aria-required="true">
                            
                        </div>

                        <div class="col-md-5 col-sm-5 col-xs-10">
                            
                                <!-- <label for="mce-EMAIL">Email Address <span class="asterisk"></span>
                                </label> -->
                                <input type="email" value="" name="EMAIL" required="" class="required email form-control footer-input" id="mce-EMAIL" placeholder="Email Address" aria-required="true">
                            
                        </div>
                        
                        
                        <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                        </div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                        <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_569e6215860c116586a158d8f_0f2eb5bc7f" tabindex="-1" value=""></div>
                        
                        <div class="col-md-1 col-sm-1 col-xs-2 submit-col">
                        <!-- <input type="submit" value="Subscribe" name="subscribe" class="submit-btn" id="mc-embedded-subscribe" class="button"> -->
                            <button type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button submit-btn"><i class="fa fa-angle-right"></i></button>
                        </div>

                        <div class="col-md-12" id="subscribe-result"></div>
                        </form>

                        </div>
                        <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='MMERGE3';ftypes[3]='text';fnames[4]='MMERGE4';ftypes[4]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
                        <!-- Mailchimp signup form end -->
                        </div>
                    </div>
                </div>
            </div>

                <!-- end of sign up form  -->

                <div class="col-md-6">
                    <div class="inner-content">
                        <ul class="footer-menu">
                            <li id="menu-item-6124" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6124"><a href="https://www.hraadvisors.com/about/">About</a></li>
<li id="menu-item-8715" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8715"><a href="https://www.hraadvisors.com/contact/">Contact</a></li>
<li id="menu-item-6125" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6125"><a href="https://www.hraadvisors.com/clients/">Clients</a></li>
<li id="menu-item-6126" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6126"><a href="https://www.hraadvisors.com/portfolio/">Portfolio</a></li>
<li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://www.hraadvisors.com/about/awards-and-recognition/">Awards</a></li>
<li id="menu-item-6127" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6127"><a href="https://www.hraadvisors.com/news/">News</a></li>
<li id="menu-item-8557" class="no-ajaxy menu-item menu-item-type-post_type menu-item-object-page menu-item-8557"><a href="https://www.hraadvisors.com/career-opportunities/">Careers</a></li>
<li id="menu-item-5625" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5625"><a href="https://www.hraadvisors.com/services/">Services</a></li>
<li id="menu-item-7929" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7929"><a href="https://www.hraadvisors.com/privacy-policy/">Privacy Policy</a></li>
    
                        </ul>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="inner-content">
                        <div class="social-links visible-sm-block visible-md-block visible-lg-block visible-md-block">
                                        <li class="fa fa-linkedin menu-item menu-item-type-custom menu-item-object-custom menu-item-7109"><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/82288">LinkedIn</a></li>
<li class="fa fa-twitter menu-item menu-item-type-custom menu-item-object-custom menu-item-7110"><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/hraadvisors">Twitter</a></li>
<li class="fa fa-facebook menu-item menu-item-type-custom menu-item-object-custom menu-item-7111"><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/hraadvisors/">Facebook</a></li>
<li class="fa fa-slideshare menu-item menu-item-type-custom menu-item-object-custom menu-item-7112"><a target="_blank" rel="noopener noreferrer" href="http://www.slideshare.net/HRAadvisors">Slide Share</a></li>
                        </div>
                        <ul>
                                        <li>New York</li><li>Los Angeles</li><li>Washington, DC</li><li>Dallas</li><li>Raleigh</li>                                        
                            
                        </ul>
                        <p class="copyright">© 2020 HR&amp;A Advisors. All Rights Reserved</p>
                    </div>
                </div>
                
            </div>
            
        </div>
    </div>
</section>
<!-- Start Footer Credits -->

</footer>
</body>
<script src="d3v4+jetpack.js"></script>
<!--<script src = 'd3.js'></script>-->
<script src="graph-scroll.js"></script>
<script src = 'https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js'></script>
<script>

var oldWidth = 0
function render(){
  if (oldWidth == innerWidth) return
  oldWidth = innerWidth

  var width = height = d3.select('#graph').node().offsetWidth
  const margin = {left: 170, top: 50, bottom: 50, right: 20} 
  var r = 40


  if (innerWidth <= 925){
    width = innerWidth
    height = innerHeight*1.7
    const margin = {left: 170, top: 50, bottom: 50, right: 20} 
  }

  
  console.log(width)
  console.log(height)

  width2 = (width/10)*8
  height2 = (height/10)*8

  widthmargin =  (width/10)
  heightmargin =  (height/10)

let dataset, svg
let salarySizeScale, salaryXScale, categoryColorScale
let simulation, nodes
let categoryLegend, salaryLegend

const categories = ['Job can be conducted virtually','Job can be made virtual','Cannot work remotely, non-essential','Cannot work remotely, essential']

const categoriesXY = {'Job can be conducted virtually': [(width/4), (height/4), 42745, 23, 37532652, '#64B3FF'],
                        'Job can be made virtual': [(width/4)*3,  (height/4), 36342, 19, 30289608, '#002E5C'],
                        'Cannot work remotely, non-essential': [ (width/4),  (height/4)*3, 36900, 19, 30292450, '#D9D9D9'], 
                        'Cannot work remotely, essential': [(width/4)*3,  (height/4)*3, 33062, 40, 64438818, '#A5A5A5'],
                        }
  console.log(categoriesXY)
  
  /////Import Data
d3.csv("data/occupations.csv", function(d){
  return{
    Major: d.Major,
    Total: +d.Total,
    Men: +d.Men,
    Women: +d.Women,
    Median: +d.Median,
    Unemployment: +d.Unemployment_rate,
    Category: d.Major_category,
    ShareWomen: +d.ShareWomen, 
    HistCol: +d.Histogram_column,
    Midpoint: +d.midpoint,
    Gender: +d.gender,
    Race: +d.race
  };
}, function(error, data){
if (error) throw error;
// Add circles:
  dataset = data
  console.log(dataset)

  dataset.forEach(function(d) { 
    d.radius = 0;
    d.x = width/2; 
    d.y = height/2
  });
  
 const colors = ['#64B3FF', '#D9D9D9', '#A5A5A5', '#002E5C',]

//Create all the scales and save to global variables

function createScales(){
    salarySizeScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Median)).range([5, 35])
    salaryXScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Median)).range([widthmargin, width-widthmargin])
    salaryYScale = d3.scaleLinear().domain([20000, 110000]).range([height-heightmargin, heightmargin])
    categoryColorScale = d3.scaleOrdinal(colors, categories)
    shareWomenXScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.ShareWomen)).range([widthmargin, width-widthmargin])
    GenderScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Gender)).range([widthmargin, width-widthmargin])
    RaceScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Race)).range([widthmargin, width-widthmargin])
    enrollmentScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Total)).range([widthmargin, width-widthmargin])
    enrollmentSizeScale = d3.scaleLinear().domain(d3.extent(dataset, d=> d.Total)).range([3,30])
    histXScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.Midpoint)).range([widthmargin, width-widthmargin])
    histYScale = d3.scaleLinear().domain(d3.extent(dataset, d => d.HistCol)).range([height-heightmargin, heightmargin])
}

function createLegend(x, y){
    let svg = d3.select('#legend')

    svg.append('g')
        .attr('class', 'categoryLegend')
        .attr('transform', `translate(${x},${y})`)

    categoryLegend = d3.legendColor()
                            .shape('path', d3.symbol().type(d3.symbolCircle).size(150)())
                            .shapePadding(10)
                            .scale(categoryColorScale)
    
    d3.select('.categoryLegend')
        .call(categoryLegend)
}

function createSizeLegend(){
    let svg = d3.select('#legend2')
    svg.append('g')
        .attr('class', 'sizeLegend')
        .attr('transform', `translate(100,50)`)

    sizeLegend2 = d3.legendSize()
        .scale(enrollmentSizeScale)
        .shape('circle')
        .shapePadding(15)
        .title('Salary Scale')
        .labelFormat(d3.format("$,.2r"))
        .cells(7)

    d3.select('.sizeLegend')
        .call(sizeLegend2)
}

function createSizeLegend2(){
    let svg = d3.select('#legend3')
    svg.append('g')
        .attr('class', 'sizeLegend2')
        .attr('transform', `translate(50,100)`)

    sizeLegend2 = d3.legendSize()
        .scale(enrollmentSizeScale)
        .shape('circle')
        .shapePadding(55)
        .orient('horizontal')
        .title('Total Employment')
        .labels(['10,000', '500,000', '4,000,000'])
        .labelOffset(30)
        .cells(3)

    d3.select('.sizeLegend2')
        .call(sizeLegend2)
}





// All the initial elements should be create in the drawInitial function
// As they are required, their attributes can be modified
// They can be shown or hidden using their 'opacity' attribute
// Each element should also have an associated class name for easy reference

function drawInitial(){
    //createSizeLegend()
    createSizeLegend2()

    let svg = d3.select("#graph")
                    .append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .attr('opacity', 1)


  svg.append("svg:defs")
  .append("svg:marker")
  .attr("id", "arrow")
  .style("fill","gray")  
  .attr("refX", 2)
  .attr("refY", 6)
  .attr("markerWidth", 5)
  .attr("markerHeight", 5)
  .attr("viewBox","0 0 13 13")
  .attr("orient", "auto")
  .append("svg:path")
  .attr("d", "M2,2 L2,11 L10,6 L2,2");

  var line = svg.append("line")
            .attr("class","maleline")
             .attr("x1",(width/10)*4)  
             .attr("y1",(height/10)*3)  
             .attr("x2",(width/10)*2)  
             .attr("y2",(height/10)*3)
             .attr("opacity",0)  
             .attr("stroke","gray")  
             .attr("stroke-width",2)  
             .attr("marker-end","url(#arrow)");

  var line = svg.append("line")
            .attr("class","femaleline")
             .attr("x1",(width/10)*6)  
             .attr("y1",(height/10)*3)  
             .attr("x2",(width/10)*8)  
             .attr("y2",(height/10)*3)
             .attr("opacity",0)  
             .attr("stroke","gray")  
             .attr("stroke-width",2)  
             .attr("marker-end","url(#arrow)");



    //SVG filter for the gooey effect
    //Code taken from http://tympanus.net/codrops/2015/03/10/creative-gooey-effects/
    var defs = svg.append("defs");
    var filter = defs.append("filter").attr("id","gooeyCodeFilter");
    filter.append("feGaussianBlur")
        .attr("in","SourceGraphic")
        .attr("stdDeviation","10")
        //to fix safari: http://stackoverflow.com/questions/24295043/svg-gaussian-blur-in-safari-unexpectedly-lightens-image
        .attr("color-interpolation-filters","sRGB") 
        .attr("result","blur");
    filter.append("feColorMatrix")
        .attr("class", "blurValues")
        .attr("in","blur")
        .attr("mode","matrix")
        .attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 6 -5")
        .attr("result","gooey");
    filter.append("feBlend")
        .attr("in","SourceGraphic")
        .attr("in2","gooey")
        .attr("operator","atop");                




    let xAxis = d3.axisBottom(salaryXScale)
                    .ticks(4)
                    .tickSize(height + 80)

    let xAxisGroup = svg.append('g')
        .attr('class', 'first-axis')
        .attr('transform', 'translate(0, 0)')
        .call(xAxis)
        .call(g => g.select('.domain')
            .remove())
        .call(g => g.selectAll('.tick line'))
            .attr('stroke-opacity', 0)
            .attr('stroke-dasharray', 0)
            .attr('opacity', 0)

    // Instantiates the force simulation
    // Has no forces. Actual forces are added and removed as required

    simulation = d3.forceSimulation(dataset)

     // Define each tick of simulation
    simulation.on('tick', () => {
        nodes
            .attr('cx', d => d.x)
            .attr('cy', d => d.y)
    })

    // Stop the simulation until later
    simulation.stop()

    // Selection of all the circles 
    
    var nodeWrapper = svg.append("g")
                .attr("class", "cityWrapper")
                .style("filter", "url(#gooeyCodeFilter)");

    nodes = nodeWrapper
        .selectAll('.occs')
        .data(dataset)
        .enter()
        .append('circle')
            .attr('fill', 'white')
            .attr("class", "occs")
            .attr('opacity', 1)
    
    var coverCirleRadius = 40;
            //Circle over all others
            nodeWrapper.append("circle")
                .attr("class", "nodeCover")
                .attr("r", 0)
                .attr("cx", width/2)
                .attr("cy", height/2);


    // Add mouseover and mouseout events for all circles
    // Changes opacity and adds border
    svg.selectAll('.occs')
        .on('mouseover', mouseOver)
        .on('mouseout', mouseOut)

    function mouseOver(d, i){

        d3.select(this)
            .transition('mouseover').duration(100)
            .attr('opacity', 1)
            .attr('stroke-width', 5)
            .attr('stroke', 'black')
            
        d3.select('#tooltip')
            .style('left', (d3.event.pageX + 10)+ 'px')
            .style('top', (d3.event.pageY - 25) + 'px')
            .style('display', 'inline-block')
            .html(`<strong style='color: ${categoriesXY[d.Category][5]}'>Occupation:</strong> ${d.Major[0] + d.Major.slice(1,).toLowerCase()}
                <br> <strong style='color: ${categoriesXY[d.Category][5]}'>Median Salary:</strong> $${d3.format(",.2r")(d.Median)}
                <br> <strong style='color: ${categoriesXY[d.Category][5]}'>Total Employed:</strong> ${d3.format(",.2r")(d.Total)}`)
    }
    
    function mouseOut(d, i){
        d3.select('#tooltip')
            .style('display', 'none')

        d3.select(this)
            .transition('mouseout').duration(100)
            .attr('opacity', 0.8)
            .attr('stroke-width', 0)

        svg.selectAll('.occ')
            .attr('stroke-width', 0)
    }

    //Small text label for first graph
 


    svg.append('text')
            .text('More Female')
            .attr('class', 'female-text')
            .attr('x', ((width/10)*7)-5)
            .attr('y', ((height/10)*3)-10)
            .attr('font-size', 13)
            .attr('color', "gray")
            .attr('text-anchor', 'middle')
            .attr('opacity', 0)

    svg.append('text')
            .text('More Male')
            .attr('class', 'male-text')
            .attr('x', ((width/10)*3)-5)
            .attr('y', ((height/10)*3)-10)
            .attr('font-size', 13)
            .attr('color', "gray")
            .attr('text-anchor', 'middle')
            .attr('opacity', 0)
    
    //All the required components for the small multiples charts
    //Initialises the text and rectangles, and sets opacity to 0 







    svg.selectAll('.cat-text')
        .data(categories).enter()
        .append('text')
        .attr('class', 'cat-text')
        .attr('opacity', 0)
        .raise()

    svg.selectAll('.cat-text')
        .text(function(d){return d})
        .style("text-anchor", "middle")
        .attr('x', d => categoriesXY[d][0] + 200 + 1000)
        .attr('y', d => categoriesXY[d][1] - 500)
        .attr('font-family', 'Domine')
        .attr('font-size', '12px')
        .attr('font-weight', 700)
        .attr('fill', 'black')
        .attr('text-anchor', 'middle')

    svg.selectAll('.tot-text')
        .data(categories).enter()
        .append('text')
        .attr('class', 'tot-text')
        .attr('opacity', 0)
        .raise()

    svg.selectAll('.tot-text')
        .text(function(d){return d})
        .style("text-anchor", "middle")
        .attr('x', d => categoriesXY[d][0] + 200 + 1000)
        .attr('y', d => categoriesXY[d][1] - 500)
        .attr('font-family', 'Domine')
        .attr('font-size', '12px')
        .attr('font-weight', 700)
        .attr('fill', 'black')
        .attr('text-anchor', 'middle')


    svg.selectAll('.lab-text')
        .data(categories).enter()
        .append('text')
        .attr('class', 'lab-text')
        .attr('opacity', 0)
        .raise()

    svg.selectAll('.lab-text')
        .text(function(d){return d})
        .style("text-anchor", "middle")
        .attr('x', d => categoriesXY[d][0] + 200 + 1000)
        .attr('y', d => categoriesXY[d][1] - 500)
        .attr('font-family', 'Domine')
        .attr('font-size', '12px')
        .attr('font-weight', 700)
        .attr('fill', 'black')
        .attr('text-anchor', 'middle')       

    svg.selectAll('.lab-text')
            .on('mouseover', function(d, i){
                d3.select(this)
                    .text(d)
            })
            .on('mouseout', function(d, i){
                d3.select(this)
                    .text(d)
            })
    svg.append('text')
            .text('All Occupations')
            .attr('class', 'all-occs')
            .attr('x', (width/2))
            .attr('y', ((height/10)+heightmargin))
            .attr('font-size', 24)
            .attr('color', "grey")
            .attr('text-anchor', 'middle')
            .attr('opacity', 0)
            .transition(10000).delay(2000)
            .attr('opacity', 0)

    svg.append('line')
        .attr('class', 'dash-line')
        .style("stroke", "gray")
        .style("stroke-dasharray", ("3, 3"))
        .attr("x1", width/2)
        .attr("y1", (height/10)*3)    
        .attr("x2", width/2)      
        .attr("y2", (height/10)*7) 
        .attr('opacity', 0)

    // Best fit line for gender scatter plot

    const bestFitLine = [{x: 0, y: 56093}, {x: 1, y: 25423}]
    const lineFunction = d3.line()
                            .x(d => shareWomenXScale(d.x))
                            .y(d => salaryYScale(d.y))

    // Axes for Scatter Plot
    svg.append('path')
        .transition('best-fit-line').duration(430)
            .attr('class', 'best-fit')
            .attr('d', lineFunction(bestFitLine))
            .attr('stroke', 'grey')
            .attr('stroke-dasharray', 6.2)
            .attr('opacity', 0)
            .attr('stroke-width', 3)

    let scatterxAxis = d3.axisBottom(shareWomenXScale)
    let scatteryAxis = d3.axisLeft(salaryYScale).tickSize([width])

    svg.append('g')
        .call(scatterxAxis)
        .attr('class', 'scatter-x')
        .attr('opacity', 0)
        .attr('transform', `translate(0, ${height - heightmargin + 10})`)
        .call(g => g.select('.domain')
            .remove())
    
    svg.append('g')
        .call(scatteryAxis)
        .attr('class', 'scatter-y')
        .attr('opacity', 0)
        .attr('transform', `translate(${width2}, 0)`)
        .call(g => g.select('.domain')
            .remove())
        .call(g => g.selectAll('.tick line'))
            .attr('stroke-opacity', 0.2)
            .attr('stroke-dasharray', 2.5)

    // Axes for Histogram 

    let histxAxis = d3.axisBottom(enrollmentScale)

    svg.append('g')
        .attr('class', 'enrolment-axis')
        .attr('transform', 'translate(0, 700)')
        .attr('opacity', 0)
        .call(histxAxis)
}

//Cleaning Function
//Will hide all the elements which are not necessary for a given chart type 

function clean(chartType){
    let svg = d3.select('#graph').select('svg')
    if (chartType !== "isScatter") {
        svg.select('.scatter-x').transition().attr('opacity', 0)
        svg.select('.scatter-y').transition().attr('opacity', 0)
        svg.select('.best-fit').transition().duration(200).attr('opacity', 0)
    }
    if (chartType !== "isMultiples"){
        svg.selectAll('.lab-text').transition().attr('opacity', 0)
            .attr('x', 1800)
        svg.selectAll('.cat-text').transition().attr('opacity', 0)
            .attr('x', 1800)
        svg.selectAll('.tot-text').transition().attr('opacity', 0)
            .attr('x', 1800)

    }
    if (chartType !== "isFirst"){
        svg.select('.first-axis').transition().attr('opacity', 0)
        svg.selectAll('.small-text').transition().attr('opacity', 0)
            .attr('x', -200)
    }
    if (chartType !== "isHist"){
        svg.selectAll('.hist-axis').transition().attr('opacity', 0)
    }
    if (chartType !== "isBubble"){
        svg.select('.enrolment-axis').transition().attr('opacity', 0)
    }
}

  createScales()
  setTimeout(drawInitial(), 100)

    /////Steps
    function stepone(){

    /*let svg = d3.select("#graph")
                    .select('svg')
                    .attr('width', width)
                    .attr('height',width)
    

    d3.select('.categoryLegend').transition().remove() */
      }

    function steptwo(){
    clean('none')

    

    let svg = d3.select("#graph")
                    .select('svg')
                    .attr('width', width)
                    .attr('height',width)

    svg.selectAll('.all-occs')
            .transition(2000).duration(2000).delay(2000)
            .attr('opacity', 1)
    

    d3.select('.categoryLegend').transition().remove()
        
    d3.selectAll(".blurValues")
                    .transition().duration(4000)
                    .attrTween("values", function() { 
                        return d3.interpolateString("1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 6 -5", 
                                                    "1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 6 -5"); 
                    });

    svg.selectAll('.occs')
        .transition()
        //.attr('r', d => enrollmentSizeScale(d.Total) * .5)
        .attr('r', d => enrollmentSizeScale(d.Total))
        .attr('fill', "#002E5C")
        .attr('opacity', 1)




    simulation 
        .force('charge', d3.forceManyBody().strength([-5]))
        .force('forceX', d3.forceX(width/2))
        .force('forceY', d3.forceY(height/2))
        .force('collide', 0)
        //.velocityDecay(0.2)
        .alphaDecay(0.02)
        .alpha(0.9)
        .restart()

    simulation.force('collide', d3.forceCollide(d => enrollmentSizeScale(d.Total) + 2))

    createLegend(20, 50)
      }

    function stepthree(){
      let svg = d3.select("#graph").select('svg')
    
    clean('none')

    svg.selectAll(".all-occs").transition(500).attr("opacity",0)

    d3.selectAll(".nodeCover")
                    .transition().duration(200)
                    .attr("r", 0);


    svg.selectAll('.occs')
        .transition().duration(300)
        .attr('r', d => enrollmentSizeScale(d.Total))
        .attr('fill', d => categoriesXY[d.Category][5])


    svg.selectAll('.cat-text').transition().duration(300).delay((d, i) => i * 30)
        .text(function(d){return d})
        .style("text-anchor", "middle")
        .style("font-weight", "700")
        .style("font-size", "1.1em")
        .style('stroke', '#FFFFFF')
        .style('stroke-opacity', .8)
        .attr('stroke-width', 5)
        .style('paint-order', 'stroke')
        .attr('x', d => categoriesXY[d][0])   
        .attr('y', d => categoriesXY[d][1]+ 50)
        .attr('opacity', 1)

        svg.selectAll('.tot-text').transition().duration(300).delay((d, i) => i * 30)
        .text(d => `(${d3.format(",.2r")(categoriesXY[d][4])} Jobs)`)  
        .style("text-anchor", "middle")
        .style("font-weight", "500")
        .style("font-size", "14.5px")
        .style('stroke', '#FFFFFF')
        .style('stroke-opacity', .8)
        .attr('stroke-width', 5)
        .style('paint-order', 'stroke')
        .attr('x', d => categoriesXY[d][0])   
        .attr('y', d => categoriesXY[d][1]+ 25)
        .attr('opacity', 1)


    svg.selectAll('.lab-text').transition().duration(300).delay((d, i) => i * 30)
        .text(d => `${(categoriesXY[d][3])}%`)
        .style("text-anchor", "middle")
        .style("font-weight", "700")
        .style("font-size", "3.1em")
        .style('stroke', '#FFFFFF')
        .style('stroke-opacity', .8)
        .attr('stroke-width', 5)
        .style('paint-order', 'stroke')
        .attr('x', d => categoriesXY[d][0])   
        .attr('y', d => categoriesXY[d][1])
        .attr('opacity', 1)

    svg.selectAll('.lab-text')
        .on('mouseover', function(d, i){
            d3.select(this)
                .text(d => `${(categoriesXY[d][3])}%`)
        })
        .on('mouseout', function(d, i){
            d3.select(this)
                .text(d => `${(categoriesXY[d][3])}%`)
        })

    simulation  
        .force('charge', d3.forceManyBody().strength([-5]))
        .force('forceX', d3.forceX(d => categoriesXY[d.Category][0]))
        .force('forceY', d3.forceY(d => categoriesXY[d.Category][1] ))
        .force('collide', 0)
        .velocityDecay(0.5)
        .alphaDecay(.02)

    //Reheat simulation and restart
    simulation.alpha(0.9).restart()

    simulation.force('collide', d3.forceCollide(d => enrollmentSizeScale(d.Total) + 2))
    
    createLegend(20, 50)
      }

    function stepfour(){

    let svg = d3.select('#graph').select('svg')

    svg.selectAll('.dash-line').transition().duration(300)
    .attr('opacity', 0)

    svg.selectAll('.femaleline').transition().duration(300)
    .attr('opacity', 0)

    svg.selectAll('.female-text').transition().duration(300)
    .attr('opacity', 0)

     svg.selectAll('.maleline').transition().duration(300)
    .attr('opacity', 0)

    svg.selectAll('.male-text').transition().duration(300)
    .attr('opacity', 0)

    clean('isHist')

    simulation.stop()

    svg.selectAll('.occs')
        .transition().duration(1000).delay(200) //(d, i) => i * 1.2).ease(d3.easeBack)
            .attr('r', 5)
            .attr('cx', d => histXScale(d.Midpoint))
            .attr('cy', d => histYScale(d.HistCol))
            .attr('fill', d => categoryColorScale(d.Category))

    let xAxis = d3.axisBottom(histXScale)
    svg.append('g')
        .attr('class', 'hist-axis')
        .attr('transform', `translate(0, ${height - heightmargin + 10})`)
        .call(xAxis)

    svg.selectAll('.lab-text')
        .on('mouseout', )
      }

    function stepfive(){
      let svg = d3.select("#graph").select('svg')
      clean('isMultiples')

      svg.selectAll('.hist-axis').transition().attr('opacity', 0)

      svg.selectAll('.dash-line').transition().duration(300)
      .attr('opacity', 1)

      svg.selectAll('.femaleline').transition().duration(300)
      .attr('opacity', 1)


      svg.selectAll('.female-text').transition().duration(300)
      .attr('opacity', 1)
      .text('More Female')

       svg.selectAll('.maleline').transition().duration(300)
      .attr('opacity', 1)

      svg.selectAll('.male-text').transition().duration(300)
      .attr('opacity', 1)
      .text('More Male')



      svg.selectAll('.occs')
          .transition().duration(100)
          .attr('r', d => enrollmentSizeScale(d.Total)) //d => enrollmentSizeScale(d.Total) * .5
          .attr('fill', d => categoriesXY[d.Category][5]).on("end", function(){
          simulation
          .force('charge', d3.forceManyBody().strength([-5]))
          .force('forceX', d3.forceX(d => GenderScale(d.Gender)).strength(1))
          .force('forceY', d3.forceY(height/2).strength(.2))
          .force('collide', 0) //d => enrollmentSizeScale(d.Total) * .5)
          .velocityDecay(0.6)
          .alphaDecay(.02)
          .alpha(0.9)
          .restart()

          simulation.force('collide', d3.forceCollide(d => (enrollmentSizeScale(d.Total)) + 2))
        })
          
      }
      
    function stepsix(){

      d3.selectAll('.male-text').transition().duration(300)
      .text('More Non-white')

      d3.selectAll('.female-text').transition().duration(300)
      .text('More White')

      let svg = d3.select("#graph").select('svg')
      clean('isMultiples')

      svg.selectAll('.hist-axis').transition().attr('opacity', 0)

      svg.selectAll('.occs')
          .transition().duration(400)
          .attr('r', d => enrollmentSizeScale(d.Total)) //
          .attr('fill', d => categoriesXY[d.Category][5])
          
      simulation  
          .force('charge', d3.forceManyBody().strength([-5]))
          .force('forceX', d3.forceX(d => RaceScale(d.Race) ).strength(1))
          .force('forceY', d3.forceY(height/2))
          .force('collide', d3.forceY(height/2)) //d => enrollmentSizeScale(d.Total) * .5)
          .alpha(0.9).alphaDecay(0.02).restart()

      simulation.force('collide', d3.forceCollide(d => (enrollmentSizeScale(d.Total)) +2))
      }

       function stepseven(){

      /*let svg = d3.select("#graph").select('svg')
      clean('isMultiples')

      svg.selectAll('.hist-axis').transition().attr('opacity', 0)

      svg.selectAll('.occs')
          .transition().duration(400).delay((d, i) => i * 2)
          .attr('r', d => enrollmentSizeScale(d.Total) * .2) //
          .attr('fill', d => categoryColorScale(d.Category))
          
      simulation  
          .force('charge', d3.forceManyBody().strength([-6]))
          .force('forceX', d3.forceX(d => RaceScale(d.Race) ).strength(1))
          .force('forceY', d3.forceY(height/2).strength(.5))
          .force('collide', d3.forceCollide(3)) //d => enrollmentSizeScale(d.Total) * .5)
          .alpha(0.7).alphaDecay(0.02).restart()
          */
      }


    let functions = [
        stepone,
        steptwo,
        stepthree,
        stepone,
        stepfour,
        stepfive,
        stepsix,
        stepseven]



  
  var gs = d3.graphScroll()
      .container(d3.select('.container-1'))
      .graph(d3.selectAll('container-1 #graph'))
      .eventId('uniqueId1')  // namespace for scroll and resize events
      .sections(d3.selectAll('.container-1 #sections > div'))
      // .offset(innerWidth < 900 ? innerHeight - 30 : 200)
      .on('active', function(i){
        functions[i]()    
      })


  //Select second graph
  var svg2 = d3.select('.container-2 #graph').html('')
    .append('svg')
      .attrs({width: width, height: height})

  var myimage = svg2.append('image')
    .attr('xlink:href', '/WFH/img/picture2.png')
    .attr('width',650)
    .attr('height', 508)

  

 });
}
render()



</script>